trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

jobs:
  - job: 'Build_Frontend'
    displayName: 'Build and Test React Frontend'
    steps:
      - task: Cache@2
        inputs:
          key: 'npm | "$(Agent.OS)" | package-lock.json'
          path: $(Pipeline.Workspace)/.npm

      - task: NodeTool@0
        inputs:
          versionSpec: '14.x'

      - script: |
          npm install --cache $(Pipeline.Workspace)/.npm
          npm run build
        displayName: 'Build React Application'

      - script: |
          npm test -- --maxWorkers=2
        displayName: 'Run Frontend Tests'
